from Greeks_mjdg import *
from tqdm import trange, tqdm

" -------- call 1 -----------------------------------------------------------------------------------------"

S = 100
K = 100
T = 1
q = 0.01
r = 0.05
sigma = 0.3
K_array = np.arange(1, 400, 1)
S_array = np.arange(1, 400, 1)

# mean = 0, var = 1 fix beta --------------------------------------------------------------------------------
# params = [[0.1, 1, 1.5, 3.68911756223351, 1.5, 0.409901951359278],
#           [0.2, 1, 1.5, 2.30483493925200, 1.5, 0.576208734813001],
#           [0.3, 1, 1.5, 1.69582971014219, 1.5, 0.726784161489509],
#           [0.4, 1, 1.5, 1.33261480900877, 1.5, 0.888409872672513],
#           [0.5, 1, 1.5, 1.08113883008419, 1.5, 1.08113883008419],
#           [0.6, 1, 1.5, 0.888409872672513, 1.5, 1.33261480900877],
#           [0.7, 1, 1.5, 0.726784161489509, 1.5, 1.69582971014219],
#           [0.8, 1, 1.5, 0.576208734813001, 1.5, 2.30483493925200],
#           [0.9, 1, 1.5, 0.409901951359278, 1.5, 3.68911756223351],
#           ]

# params = [[0.1, 1, 2, 5.16712452484701, 2, 0.574124947205223],
#           [0.2, 1, 2, 3.27921561087423, 2, 0.819803902718557],
#           [0.3, 1, 2, 2.43421973277773, 2, 1.04323702833331],
#           [0.4, 1, 2, 1.92190404258370, 2, 1.28126936172247],
#           [0.5, 1, 2, 1.56155281280883, 2, 1.56155281280883],
#           [0.6, 1, 2, 1.28126936172247, 2, 1.92190404258370],
#           [0.7, 1, 2, 1.04323702833331, 2, 2.43421973277773],
#           [0.8, 1, 2, 0.819803902718557, 2, 3.27921561087423],
#           [0.9, 1, 2, 0.574124947205223, 2, 5.16712452484701],
#           ]

params = [[0.1, 1, 5, 14.1269757436418, 5, 1.56966397151576],
          [0.2, 1, 5, 9.23194896318756, 5, 2.30798724079689],
          [0.3, 1, 5, 6.96963710571324, 5, 2.98698733101996],
          [0.4, 1, 5, 5.55304802516606, 5, 3.70203201677738],
          [0.5, 1, 5,4.52493781056044, 5, 4.52493781056044],
          [0.6, 1, 5, 3.70203201677738, 5, 5.55304802516606],
          [0.7, 1, 5, 2.98698733101996, 5, 6.96963710571324],
          [0.8, 1, 5, 2.30798724079689, 5, 9.23194896318756],
          [0.9, 1, 5, 1.56966397151576, 5, 14.1269757436418],
          ]
#

# mean = 0, var = 1 fix alpha [0.1, 1, , 1, , 1]---------------------------------------------
# params = [
            # [0.1, 1, 0.471404520791032, 1, 4.24264068711928, 1],
#           [0.2, 1, 0.707106781186548, 1, 2.82842712474619, 1],
#           [0.3, 1, 0.925820099772551, 1, 2.16024689946929, 1],
#           [0.4, 1, 1.15470053837925, 1, 1.73205080756888, 1],
#           [0.5, 1, 1.41421356237310, 1, 1.41421356237310, 1],
#           [0.6, 1, 1.15470053837925, 1, 1.73205080756888, 1]
          # [0.7, 1, 0.707106781186548, 1, 2.82842712474619, 1],
          # [0.8, 1, 0.925820099772551, 1, 2.16024689946929, 1],
          # [0.9, 1, 0.471404520791032, 1, 4.24264068711928, 1]
          # ]

# params = [
#           [0.1, 1, 1.15470053837925, 3, 10.3923048454133, 3],
#           [0.2, 1, 1.73205080756888, 3, 6.92820323027551, 3],
#           [0.3, 1, 2.26778683805536, 3, 5.29150262212918, 3],
#           [0.4, 1, 2.82842712474619, 3, 4.24264068711928, 3],
#           [0.5, 1, 3.46410161513775, 3, 3.46410161513775, 3],
#           [0.6, 1, 4.24264068711928, 3, 2.82842712474619, 3],
#           [0.7, 1, 5.29150262212918, 3, 2.26778683805536, 3],
#           [0.8, 1, 6.92820323027551, 3, 1.73205080756888, 3],
#           [0.9, 1, 10.3923048454133, 3, 1.15470053837925, 3]
#           ]

# params = [
#             [0.1, 1, 1.82574185835055, 5, 16.4316767251550, 5],
#           [0.2, 1, 2.73861278752583, 5, 10.9544511501033, 5],
#           [0.3, 1, 3.58568582800318, 5, 8.36660026534076, 5],
#           [0.4, 1, 4.47213595499958, 5, 6.70820393249937, 5],
#           [0.5, 1, 5.47722557505166, 5, 5.47722557505166, 5],
#           [0.6, 1, 6.70820393249937, 5, 4.47213595499958, 5],
#           [0.7, 1, 8.36660026534076, 5, 3.58568582800318, 5],
#           [0.8, 1, 10.9544511501033, 5, 2.73861278752583, 5],
#           [0.9, 1, 16.4316767251550, 5, 1.82574185835055, 5]
#           ]


# mean = 0.2, var = 1 fix beta --------------------------------------------------------------------------------
# params = [[0.1, 1, 1.5, 4.21871352126270, 1.5, 0.135412613473634],
#           [0.2, 1, 1.5, 2.71869538788622, 1.5, 0.304673846971554],
#           [0.3, 1, 1.5, 2.05356882927706, 1.5, 0.451529498261597],
#           [0.4, 1, 1.5, 1.65576072156079, 1.5, 0.603840481040530],
#           [0.5, 1, 1.5, 1.38113883008419, 1.5, 0.781138830084190],
#           [0.6, 1, 1.5, 1.17279220613579, 1.5, 1.00918830920368],
#           [0.7, 1, 1.5, 1.00142755247554, 1.5, 1.33666428910958],
#           [0.8, 1, 1.5, 0.846659226153404, 1.5, 1.88663690461362],
#           [0.9, 1, 1.5, 0.683045891539648, 1.5, 3.14741302385683],
#           ]

# params = [[0.1, 1, 2, 5.8, 2, 0.2],
#           [0.2, 1, 2, 3.79523539268061, 2, 0.448808848170152],
#           [0.3, 1, 2, 2.89322198831629, 2, 0.668523709278412],
#           [0.4, 1, 2, 2.34558441227157, 2, 0.897056274847714],
#           [0.5, 1, 2, 1.96155281280883, 2, 1.16155281280883],
#           [0.6, 1, 2, 1.66533279957291, 2, 1.49799919935936],
#           [0.7, 1, 2, 1.41746509848052, 2, 1.97408522978788],
#           [0.8, 1, 2, 1.18994949366117, 2, 2.75979797464467],
#           [0.9, 1, 2, 0.947216261298253, 2, 4.52494635168428],
#           ]


# mean = 0.2, var = 1 fix alpha [0.1, 1, , 1, , 1]---------------------------------------------
# params = [
#           [0.2, 1, 0.630659918114416, 1, 6.83012701892219, 1],
#           [0.3, 1, 0.794722707801700, 1, 3.94388066661854, 1],
#           [0.4, 1, 0.953717849152731, 1, 2.73459080339014, 1],
#           [0.5, 1, 1.12004618869898, 1, 2.02913709778989, 1],
#           [0.6, 1, 1.30601937481871, 1, 1.54195314327038, 1],
#           [0.7, 1, 1.53008756317027, 1, 1.16509307817207, 1],
#           [0.8, 1, 1.83012701892219, 1, 0.843425875561224, 1],
#           [0.9, 1, 2.32050807568877, 1, 0.532350693710900, 1]
#           ]

# params = [
#           [0.1, 1, 1.07886597285402, 3, 34.5844544257479, 3],
#           [0.2, 1, 1.56212163021424, 3, 13.0368882072855, 3],
#           [0.3, 1, 1.98147075230360, 3, 8.26094948796712, 3],
#           [0.4, 1, 2.39317394939796, 3, 5.97161194978797, 3],
#           [0.5, 1, 2.82956797158970, 3, 4.54385368587541, 3],
#           [0.6, 1, 3.32455312625856, 3, 3.51466927650077, 3],
#           [0.7, 1, 3.93105258075063, 3, 2.69293320289649, 3],
#           [0.8, 1, 4.76102613831996, 3, 1.97308053432383, 3],
#           [0.9, 1, 6.16340194825885, 3, 1.26013485503601, 3]
#           ]

# params = [
          # [0.2, 1, 2.47717993816038, 5, 19.6381816969859, 5],
          # [0.3, 1, 3.14694117458818, 5, 12.6512121163635, 5],
          # [0.4, 1, 3.80647030235835, 5, 9.21882308195220, 5],
          # [0.5, 1, 4.50770410889231, 5, 7.05007699024824, 5],
          # [0.6, 1, 5.30577960369133, 5, 5.47313696902502, 5],
          # [0.7, 1, 6.28757575272712, 5, 4.20576470399994, 5],
          # [0.8, 1, 7.63818169698586, 5, 3.08942483611956, 5],
          # [0.9, 1, 9.93896077925540, 5, 1.97813266175485, 5]
          # ]


# mean = 0.0, var = 0.5 fix beta --------------------------------------------------------------------------------
# params = [[0.1, 1, 1.5, 2.40681115275729, 1.5, 0.267423461417477],
#           [0.2, 1, 1.5, 1.46715680975093, 1.5, 0.366789202437732],
#           [0.3, 1, 1.5, 1.06493625947228, 1.5, 0.456401254059548],
#           [0.4, 1, 1.5, 0.830908802125418, 1.5, 0.553939201416946],
#           [0.5, 1, 1.5, 0.672603939955857, 1.5, 0.672603939955857],
#           [0.6, 1, 1.5, 0.553939201416946, 1.5, 0.830908802125418],
#           [0.7, 1, 1.5, 0.456401254059548, 1.5, 1.06493625947228],
#           [0.8, 1, 1.5, 0.366789202437732, 1.5, 1.46715680975093],
#           [0.9, 1, 1.5, 0.267423461417477, 1.5, 2.40681115275729],
#           ]

# params = [[0.1, 1, 2, 3.43704968844029, 2, 0.381894409826699],
#           [0.2, 1, 2, 2.13938769133981, 2, 0.534846922834953],
#           [0.3, 1, 2, 1.57082951070015, 2, 0.673212647442920],
#           [0.4, 1, 2, 1.23303027798234, 2, 0.822020185321557],
#           [0.5, 1, 2, 1.0, 2, 1.0],
#           [0.6, 1, 2, 0.822020185321557, 2, 1.23303027798234],
#           [0.7, 1, 2, 0.673212647442920, 2, 1.57082951070015],
#           [0.8, 1, 2, 0.534846922834953, 2, 2.13938769133981],
#           [0.9, 1, 2, 0.381894409826699, 2, 3.43704968844029],
#           ]
#
# params = [[0.1, 1, 5, 9.74471699952610, 5, 1.08274633328068],
#           [0.2, 1, 5, 6.31617874986288, 5, 1.57904468746572],
#           [0.3, 1, 5, 4.74579348365935, 5, 2.03391149299687],
#           [0.4, 1, 5, 3.77149859887888, 5, 2.51433239925259],
#           [0.5, 1, 5, 3.07071421427142, 5, 3.07071421427142],
#           [0.6, 1, 5, 2.51433239925259, 5, 3.77149859887888],
#           [0.7, 1, 5, 2.03391149299687, 5, 4.74579348365935],
#           [0.8, 1, 5, 1.57904468746572, 5, 6.31617874986288],
#           [0.9, 1, 5, 1.08274633328068, 5, 9.74471699952610],
#           ]

# mean = 0, var = 0.5 fix alpha [0.1, 1, , 1, , 1]---------------------------------------------
# params = [
          # [0.1, 1, 0.666666666666667, 1, 6.00000000000000, 1],
          # [0.2, 1, 1.00000000000000, 1, 4.00000000000000, 1],
          # [0.3, 1, 1.30930734141595, 1, 3.05505046330389, 1],
          # [0.4, 1, 1.63299316185545, 1, 2.44948974278318, 1],
          # [0.5, 1, 2.0, 1, 2.0, 1],
          # [0.6, 1, 2.44948974278318, 1, 1.63299316185545, 1],
          # [0.7, 1, 3.05505046330389, 1, 1.30930734141595, 1],
          # [0.8, 1, 4.00000000000000, 1, 1.00000000000000, 1],
          # [0.9, 1, 6.00000000000000, 1, 0.666666666666667, 1]
          # ]

# params = [
#           [0.1, 1, 1.63299316185545, 3, 14.6969384566991, 3],
#           [0.2, 1, 2.44948974278318, 3, 9.79795897113271, 3],
#           [0.3, 1, 3.20713490294909, 3, 7.48331477354788, 3],
#           [0.4, 1, 4.0, 3, 6.0, 3],
#           [0.5, 1, 4.89897948556636, 3, 4.89897948556636, 3],
#           [0.6, 1, 6.0, 3, 4.0, 3],
#           [0.7, 1, 7.48331477354788, 3, 3.20713490294909, 3],
#           [0.8, 1, 9.79795897113271, 3, 2.44948974278318, 3],
#           [0.9, 1, 14.6969384566991, 3, 1.63299316185545, 3]
#           ]

# params = [
#           [0.1, 1, 2.58198889747161, 5, 23.2379000772442, 5],
#           # [0.2, 1, 3.87298334620742, 5, 15.4919333848297, 5],
#           # [0.3, 1, 5.07092552837110, 5, 11.8321595661992, 5],
#           [0.4, 1, 6.32455532033676, 5, 9.48683298050514, 5],
#           [0.5, 1, 7.74596669241483, 5, 7.74596669241483, 5],
#           [0.6, 1, 9.48683298050514, 5, 6.32455532033676, 5],
#           [0.7, 1, 11.8321595661992, 5, 5.07092552837110, 5],
#           # [0.8, 1, 15.4919333848297, 5, 3.87298334620742, 5],
#           # [0.9, 1, 23.2379000772442, 5, 2.58198889747161, 5]
#           ]

# mean = 0.0, var = 1.5 fix beta --------------------------------------------------------------------------------
# params = [[0.1, 1, 1.5, 4.68435314069589, 1.5, 0.520483682299543],
#           [0.2, 1, 1.5, 2.96031913539263, 1.5, 0.740079783848158],
#           [0.3, 1, 1.5, 2.19223097279591, 1.5, 0.939527559769678],
#           [0.4, 1, 1.5, 1.72862620443900, 1.5, 1.15241746962600],
#           [0.5, 1, 1.5, 1.40394327646598, 1.5, 1.40394327646598],
#           [0.6, 1, 1.5, 1.15241746962600, 1.5, 1.72862620443900],
#           [0.7, 1, 1.5, 0.939527559769678, 1.5, 2.19223097279591],
#           [0.8, 1, 1.5, 0.740079783848158, 1.5, 2.96031913539263],
#           [0.9, 1, 1.5, 0.520483682299543, 1.5, 4.68435314069589],
#           ]
# #
# params = [[0.1, 1, 2, 6.50337760755184, 2, 0.722597511950204],
#           [0.2, 1, 2, 4.16386945839634, 2, 1.04096736459909],
#           [0.3, 1, 2, 3.10657326213486, 2, 1.33138854091494],
#           [0.4, 1, 2, 2.45941170815567, 2, 1.63960780543711],
#           [0.5, 1, 2, 2.00, 2, 2.00],
#           [0.6, 1, 2, 1.63960780543711, 2, 2.45941170815567],
#           [0.7, 1, 2, 1.33138854091494, 2, 3.10657326213486],
#           [0.8, 1, 2, 1.04096736459909, 2, 4.16386945839634],
#           [0.9, 1, 2, 0.722597511950204, 2, 6.50337760755184],
#           ]

# params = [[0.1, 1, 5, 17.4932052671632, 5, 1.94368947412924],
#           [0.2, 1, 5, 11.4735487940530, 5, 2.86838719851325],
#           [0.3, 1, 5, 8.68029850271301, 5, 3.72012792973415],
#           [0.4, 1, 5, 6.92396172239067, 5, 4.61597448159378],
#           [0.5, 1, 5, 5.64410286372225, 5, 5.64410286372225],
#           [0.6, 1, 5, 4.61597448159378, 5, 6.92396172239067],
#           [0.7, 1, 5, 3.72012792973415, 5, 8.68029850271301],
#           [0.8, 1, 5, 2.86838719851325, 5, 11.4735487940530],
#           [0.9, 1, 5, 1.94368947412924, 5, 17.4932052671632],
#           ]

# mean = 0, var = 1.5 fix alpha [0.1, 1, , 1, , 1]---------------------------------------------
# params = [
#           [0.1, 1, 0.384900179459751, 1, 3.46410161513775, 1],
#           [0.2, 1, 0.577350269189626, 1, 0.577350269189626, 1],
#           [0.3, 1, 0.755928946018454, 1, 1.76383420737639, 1],
#           [0.4, 1, 0.942809041582063, 1, 1.41421356237309, 1],
#           [0.5, 1, 1.15470053837925, 1, 1.15470053837925, 1],
#           [0.6, 1, 1.41421356237309, 1, 0.942809041582063, 1]
#           [0.7, 1, 1.76383420737639, 1, 0.755928946018454, 1],
#           [0.8, 1, 0.577350269189626, 1, 0.577350269189626, 1],
#           [0.9, 1, 3.46410161513775, 1, 0.384900179459751, 1]
#           ]

# params = [
#           [0.1, 1, 0.942809041582063, 3, 8.48528137423857, 3],
#           [0.2, 1, 1.41421356237310, 3, 5.65685424949238, 3],
#           [0.3, 1, 1.85164019954510, 3, 4.32049379893857, 3],
#           [0.4, 1, 2.30940107675850, 3, 3.46410161513775, 3],
#           [0.5, 1, 2.82842712474619, 3, 2.82842712474619, 3],
#           [0.6, 1, 3.46410161513775, 3, 2.30940107675850, 3],
#           [0.7, 1, 4.32049379893857, 3, 1.85164019954510, 3],
#           [0.8, 1, 5.65685424949238, 3, 1.41421356237310, 3],
#           [0.9, 1, 8.48528137423857, 3, 0.942809041582063, 3]
#           ]

# params = [
#           [0.1, 1, 1.49071198499986, 5, 13.4164078649987, 5],
#           [0.2, 1, 2.23606797749979, 5, 8.94427190999916, 5],
#           [0.3, 1, 2.92770021884560, 5, 6.83130051063973, 5],
#           [0.4, 1, 3.65148371670111, 5, 5.47722557505166, 5],
#           [0.5, 1, 4.4721359549995, 5, 4.4721359549995, 5],
#           [0.6, 1, 5.47722557505166, 5, 3.65148371670111, 5],
#           [0.7, 1, 6.83130051063973, 5, 2.92770021884560, 5],
#           [0.8, 1, 8.94427190999916, 5, 2.23606797749979, 5],
#           [0.9, 1, 13.4164078649987, 5, 1.49071198499986, 5]
#           ]



"call"
for i in trange(len(params)):
    call_gamma = CfOptionPricing(S, K, r, q, T, sigma, 'Merton_Double_gamma', "call", -2, 12, 0.25, 5, K_array, S_array, params[i])
    call_gamma_prices_spot = call_gamma.evaluate_integral_many_S0()
    plt.plot(S_array, call_gamma_prices_spot, label=f'alpha_1 = {round(params[i][3], 3)}, alpha_2 = {round(params[i][5], 3)}, p = {params[i][0]}')
    # plt.plot(S_array, call_gamma_prices_spot, label=f'beta_1 = {round(params[i][2], 3)}, beta_2 = {round(params[i][4], 3)}, p = {params[i][0]}')

plt.xlabel('$S_0$')
plt.ylabel('call value')
# plt.title(f'Effect of change in alpha on Call value: mean = 0.0, var = 0.5, poi_lamda = 1,  alpha1 =  alpha2 = {params[0][3]} ')
plt.title(f'Call value:  mean = 0.0, var = 1, poi_lamda = 1,  beta1 =  beta2 = {params[0][2]} ')
plt.axvline(K, color='black', linestyle='dashed', linewidth=2, label="Strike")
plt.legend()
plt.show()


"delta -------------------------------------------------------------------------------------------------------------"
for i in trange(len(params)):
    greeks_c_array = []
    for S in tqdm(S_array):
        greeks_c = delta_fdm_Double_gamma(S, K, T, q, r, sigma, K_array, S_array, -2, params[i], "call", ds=1e-8,method='central')
        greeks_c_array.append(greeks_c)
    # print(greeks_c_array)
    plt.plot(S_array, greeks_c_array, label=f'alpha_1 = {round(params[i][3], 3)}, alpha_2 = {round(params[i][5], 3)}, p = {params[i][0]}')

plt.xlabel('$S_0$')
plt.ylabel('delta')
# plt.title(f' mean = 0.0, var = 0.5, poi_lamda = 1,  alpha1 =  alpha2 = {params[0][3]} ')
plt.title(f' mean = 0.0, var = 1, poi_lamda = 1,  beta1 =  beta2 = {params[0][2]} ')
plt.axvline(K, color='black', linestyle='dashed', linewidth=2, label="Strike")
plt.legend()
plt.show()

#
"gamma"
for i in trange(len(params)):
    greeks_c_array = []
    for S in tqdm(S_array):
        greeks_c = gamma_fdm_Double_gamma(S, K, T, q, r, sigma, K_array, S_array, -2, params[i], "call", ds=1e-2,method='central')
        greeks_c_array.append(greeks_c)
    # print(greeks_c_array)
    plt.plot(S_array, greeks_c_array, label=f'alpha_1 = {round(params[i][3], 3)}, alpha_2 = {round(params[i][5], 3)}, p = {params[i][0]}')

plt.xlabel('$S_0$')
plt.ylabel('gamma')
# plt.title(f' mean = 0.0, var = 0.5, poi_lamda = 1,  alpha1 =  alpha2 = {params[0][3]} ')
plt.title(f'mean = 0.0, var = 1, poi_lamda = 1,  beta1 =  beta2 = {params[0][2]} ')
plt.axvline(K, color='black', linestyle='dashed', linewidth=2, label="Strike")
plt.legend()
plt.show()

" Vega -"
for i in trange(len(params)):
    greeks_c_array = []
    for S in tqdm(S_array):
        greeks_c = vega_fdm_Double_gamma(S, K, T, q, r, sigma, K_array, S_array, -2, params[i], "call", dv=1e-4, method='central')
        greeks_c_array.append(greeks_c)
    # print(greeks_c_array)
    plt.plot(S_array, greeks_c_array, label=f'alpha_1 = {round(params[i][3], 3)}, alpha_2 = {round(params[i][5], 3)}, p = {params[i][0]}')

plt.xlabel('$S_0$')
plt.ylabel('Vega')
# plt.title(f' mean = 0.0, var = 0.5, poi_lamda = 1,  alpha1 =  alpha2 = {params[0][3]} ')
plt.title(f'mean = 0.0, var = 1, poi_lamda = 1,  beta1 =  beta2 = {params[0][2]} ')
plt.axvline(K, color='black', linestyle='dashed', linewidth=2, label="Strike")
plt.legend()
plt.show()
" theta "
for i in trange(len(params)):
    greeks_c_array = []
    for S in tqdm(S_array):
        greeks_c = theta_fdm_Double_gamma(S, K, T, q, r, sigma, K_array, S_array, -2, params[i], "call", 1e-2, method='central')
        greeks_c_array.append(greeks_c)
    # print(greeks_c_array)
    plt.plot(S_array, greeks_c_array, label=f'alpha_1 = {round(params[i][3], 3)}, alpha_2 = {round(params[i][5], 3)}, p = {params[i][0]}')

plt.xlabel('$S_0$')
plt.ylabel('theta')
# plt.title(f' mean = 0.0, var = 0.5, poi_lamda = 1,  alpha1 =  alpha2 = {params[0][3]} ')
plt.title(f'mean = 0.0, var = 1, poi_lamda = 1,  beta1 =  beta2 = {params[0][2]} ')
plt.axvline(K, color='black', linestyle='dashed', linewidth=2, label="Strike")
plt.legend()
plt.show()
"rho "

for i in trange(len(params)):
    greeks_c_array = []
    for S in tqdm(S_array):
        greeks_c = rho_fdm_Double_gamma(S, K, T, q, r, sigma, K_array, S_array, -2, params[i], "call", dr=1e-5,method='central')
        greeks_c_array.append(greeks_c)
    # print(greeks_c_array)
    plt.plot(S_array, greeks_c_array, label=f'alpha_1 = {round(params[i][3], 3)}, alpha_2 = {round(params[i][5], 3)}, p = {params[i][0]}')

plt.xlabel('$S_0$')
plt.ylabel('rho')
# plt.title(f' mean = 0.0, var = 0.5, poi_lamda = 1,  alpha1 =  alpha2 = {params[0][3]} ')
plt.title(f'mean = 0.0, var = 1, poi_lamda = 1,  beta1 =  beta2 = {params[0][2]} ')
plt.axvline(K, color='black', linestyle='dashed', linewidth=2, label="Strike")
plt.legend()
plt.show()



